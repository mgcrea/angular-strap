/**
 * angular-strap
 * @version v2.1.0 - 2014-09-21
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.datepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.tooltip"]).provider("$datepicker",function(){var e=this.defaults={animation:"am-fade",prefixClass:"datepicker",placement:"bottom-left",template:"datepicker/datepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!1,dateType:"date",dateFormat:"shortDate",modelDateFormat:null,dayFormat:"dd",monthFormat:"MMM",yearFormat:"yyyy",monthTitleFormat:"MMMM yyyy",yearTitleFormat:"yyyy",strictFormat:!1,autoclose:!1,minDate:-1/0,maxDate:+1/0,startView:0,minView:0,startWeek:0,daysOfWeekDisabled:"",iconLeft:"glyphicon glyphicon-chevron-left",iconRight:"glyphicon glyphicon-chevron-right"};this.$get=["$window","$document","$rootScope","$sce","$dateUtil","datepickerViews","$tooltip",function(t,a,n,i,o,r,d){function l(t,a,n){function i(e){e.selected=l.$isSelected(e.date)}function o(){t[0].focus()}var l=d(t,angular.extend({},e,n)),c=n.scope,g=l.$options,$=l.$scope;g.startView&&(g.startView-=g.minView);var m=r(l);l.$views=m.views;var f=m.viewDate;$.$mode=g.startView,$.$iconLeft=g.iconLeft,$.$iconRight=g.iconRight;var h=l.$views[$.$mode];$.$select=function(e){l.select(e)},$.$selectPane=function(e){l.$selectPane(e)},$.$toggleMode=function(){l.setMode(($.$mode+1)%l.$views.length)},l.update=function(e){angular.isDate(e)&&!isNaN(e.getTime())&&(l.$date=e,h.update.call(h,e)),l.$build(!0)},l.updateDisabledDates=function(e){g.disabledDateRanges=e;for(var t=0,a=$.rows.length;a>t;t++)angular.forEach($.rows[t],l.$setDisabledEl)},l.select=function(e,t){angular.isDate(a.$dateValue)||(a.$dateValue=new Date(e)),!$.$mode||t?(a.$setViewValue(angular.copy(e)),a.$render(),g.autoclose&&!t&&l.hide(!0)):(angular.extend(f,{year:e.getFullYear(),month:e.getMonth(),date:e.getDate()}),l.setMode($.$mode-1),l.$build())},l.setMode=function(e){$.$mode=e,h=l.$views[$.$mode],l.$build()},l.$build=function(e){e===!0&&h.built||(e!==!1||h.built)&&h.build.call(h)},l.$updateSelected=function(){for(var e=0,t=$.rows.length;t>e;e++)angular.forEach($.rows[e],i)},l.$isSelected=function(e){return h.isSelected(e)},l.$setDisabledEl=function(e){e.disabled=h.isDisabled(e.date)},l.$selectPane=function(e){var t=h.steps,a=new Date(Date.UTC(f.year+(t.year||0)*e,f.month+(t.month||0)*e,f.date+(t.day||0)*e));angular.extend(f,{year:a.getUTCFullYear(),month:a.getUTCMonth(),date:a.getUTCDate()}),l.$build()},l.$onMouseDown=function(e){if(e.preventDefault(),e.stopPropagation(),u){var t=angular.element(e.target);"button"!==t[0].nodeName.toLowerCase()&&(t=t.parent()),t.triggerHandler("click")}},l.$onKeyDown=function(e){if(/(38|37|39|40|13)/.test(e.keyCode)&&!e.shiftKey&&!e.altKey){if(e.preventDefault(),e.stopPropagation(),13===e.keyCode)return $.$mode?$.$apply(function(){l.setMode($.$mode-1)}):l.hide(!0);h.onKeyDown(e),c.$digest()}};var D=l.init;l.init=function(){return s&&g.useNative?(t.prop("type","date"),void t.css("-webkit-appearance","textfield")):(u&&(t.prop("type","text"),t.attr("readonly","true"),t.on("click",o)),void D())};var y=l.destroy;l.destroy=function(){s&&g.useNative&&t.off("click",o),y()};var p=l.show;l.show=function(){p(),setTimeout(function(){l.$element.on(u?"touchstart":"mousedown",l.$onMouseDown),g.keyboard&&t.on("keydown",l.$onKeyDown)})};var w=l.hide;return l.hide=function(e){l.$element.off(u?"touchstart":"mousedown",l.$onMouseDown),g.keyboard&&t.off("keydown",l.$onKeyDown),w(e)},l}var s=(angular.element(t.document.body),/(ip(a|o)d|iphone|android)/gi.test(t.navigator.userAgent)),u="createTouch"in t.document&&s;return e.lang||(e.lang=o.getDefaultLocale()),l.defaults=e,l}]}).directive("bsDatepicker",["$window","$parse","$q","$dateUtil","$datepicker","$timeout",function(e,t,a,n,i){var o=(i.defaults,/(ip(a|o)d|iphone|android)/gi.test(e.navigator.userAgent)),r=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};return{restrict:"EAC",require:"ngModel",link:function(e,t,a,d){function l(e){return e&&e.length?e:null}var s={scope:e,controller:d};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","dateType","dateFormat","modelDateFormat","dayFormat","strictFormat","startWeek","startDate","useNative","lang","startView","minView","iconLeft","iconRight","daysOfWeekDisabled"],function(e){angular.isDefined(a[e])&&(s[e]=a[e])}),a.bsShow&&e.$watch(a.bsShow,function(e){u&&angular.isDefined(e)&&(angular.isString(e)&&(e=!!e.match(",?(datepicker),?")),e===!0?u.show():u.hide())});var u=i(t,d,s);s=u.$options,o&&s.useNative&&(s.dateFormat="yyyy-MM-dd");var c=s.lang,g=function(e,t){return n.formatDate(e,t,c)};angular.forEach(["minDate","maxDate"],function(e){angular.isDefined(a[e])&&a.$observe(e,function(t){if("today"===t){var a=new Date;u.$options[e]=+new Date(a.getFullYear(),a.getMonth(),a.getDate()+("maxDate"===e?1:0),0,0,0,"minDate"===e?0:-1)}else u.$options[e]=angular.isString(t)&&t.match(/^".+"$/)?+new Date(t.substr(1,t.length-2)):r(t)?+new Date(parseInt(t,10)):angular.isString(t)&&0===t.length?"maxDate"===e?+1/0:-1/0:+new Date(t);!isNaN(u.$options[e])&&u.$build(!1)})}),e.$watch(a.ngModel,function(){u.update(d.$dateValue)},!0),angular.isDefined(a.disabledDates)&&e.$watch(a.disabledDates,function(e,t){e=l(e),t=l(t),e!==t&&u.updateDisabledDates(e)});var $=n.getDateParser({format:s.dateFormat,lang:c,strict:s.strictFormat});d.$parsers.unshift(function(e){if(!e)return void d.$setValidity("date",!0);var t=$.parse(e,d.$dateValue);if(!t||isNaN(t.getTime()))return void d.$setValidity("date",!1);var a=isNaN(u.$options.minDate)||t.getTime()>=u.$options.minDate,n=isNaN(u.$options.maxDate)||t.getTime()<=u.$options.maxDate,i=a&&n;return d.$setValidity("date",i),d.$setValidity("min",a),d.$setValidity("max",n),i&&(d.$dateValue=t),"string"===s.dateType?g(t,s.modelDateFormat||s.dateFormat):"number"===s.dateType?d.$dateValue.getTime():"iso"===s.dateType?d.$dateValue.toISOString():new Date(d.$dateValue)}),d.$formatters.push(function(e){var t;return t=angular.isUndefined(e)||null===e?0/0:angular.isDate(e)?e:"string"===s.dateType?$.parse(e,null,s.modelDateFormat):new Date(e),d.$dateValue=t,d.$dateValue}),d.$render=function(){t.val(!d.$dateValue||isNaN(d.$dateValue.getTime())?"":g(d.$dateValue,s.dateFormat))},e.$on("$destroy",function(){u&&u.destroy(),s=null,u=null})}}}]).provider("datepickerViews",function(){function e(e,t){for(var a=[];e.length>0;)a.push(e.splice(0,t));return a}function t(e,t){return(e%t+t)%t}this.defaults={dayFormat:"dd",daySplit:7};this.$get=["$dateUtil","$sce",function(a,n){return function(i){var o=i.$scope,r=i.$options,d=r.lang,l=function(e,t){return a.formatDate(e,t,d)},s=a.weekdaysShort(d),u=s.slice(r.startWeek).concat(s.slice(0,r.startWeek)),c=n.trustAsHtml('<th class="dow text-center">'+u.join('</th><th class="dow text-center">')+"</th>"),g=i.$date||(r.startDate?new Date(r.startDate):new Date),$={year:g.getFullYear(),month:g.getMonth(),date:g.getDate()},m=(6e4*g.getTimezoneOffset(),[{format:r.dayFormat,split:7,steps:{month:1},update:function(e,t){!this.built||t||e.getFullYear()!==$.year||e.getMonth()!==$.month?(angular.extend($,{year:i.$date.getFullYear(),month:i.$date.getMonth(),date:i.$date.getDate()}),i.$build()):e.getDate()!==$.date&&($.date=i.$date.getDate(),i.$updateSelected())},build:function(){var a=new Date($.year,$.month,1),n=a.getTimezoneOffset(),d=new Date(+a-864e5*t(a.getDay()-r.startWeek,7)),s=d.getTimezoneOffset(),u=(new Date).toDateString();s!==n&&(d=new Date(+d+6e4*(s-n)));for(var g,m=[],f=0;42>f;f++)g=new Date(d.getFullYear(),d.getMonth(),d.getDate()+f),m.push({date:g,isToday:g.toDateString()===u,label:l(g,this.format),selected:i.$date&&this.isSelected(g),muted:g.getMonth()!==$.month,disabled:this.isDisabled(g)});o.title=l(a,r.monthTitleFormat),o.showLabels=!0,o.labels=c,o.rows=e(m,this.split),this.built=!0},isSelected:function(e){return i.$date&&e.getFullYear()===i.$date.getFullYear()&&e.getMonth()===i.$date.getMonth()&&e.getDate()===i.$date.getDate()},isDisabled:function(e){var t=e.getTime();if(t<r.minDate||t>r.maxDate)return!0;if(-1!==r.daysOfWeekDisabled.indexOf(e.getDay()))return!0;if(r.disabledDateRanges)for(var a=0;a<r.disabledDateRanges.length;a++)if(t>=r.disabledDateRanges[a].start)return t<=r.disabledDateRanges[a].end?!0:!1;return!1},onKeyDown:function(e){var t,a=i.$date.getTime();37===e.keyCode?t=new Date(a-864e5):38===e.keyCode?t=new Date(a-6048e5):39===e.keyCode?t=new Date(a+864e5):40===e.keyCode&&(t=new Date(a+6048e5)),this.isDisabled(t)||i.select(t,!0)}},{name:"month",format:r.monthFormat,split:4,steps:{year:1},update:function(e){this.built&&e.getFullYear()===$.year?e.getMonth()!==$.month&&(angular.extend($,{month:i.$date.getMonth(),date:i.$date.getDate()}),i.$updateSelected()):(angular.extend($,{year:i.$date.getFullYear(),month:i.$date.getMonth(),date:i.$date.getDate()}),i.$build())},build:function(){for(var t,a=(new Date($.year,0,1),[]),n=0;12>n;n++)t=new Date($.year,n,1),a.push({date:t,label:l(t,this.format),selected:i.$isSelected(t),disabled:this.isDisabled(t)});o.title=l(t,r.yearTitleFormat),o.showLabels=!1,o.rows=e(a,this.split),this.built=!0},isSelected:function(e){return i.$date&&e.getFullYear()===i.$date.getFullYear()&&e.getMonth()===i.$date.getMonth()},isDisabled:function(e){var t=+new Date(e.getFullYear(),e.getMonth()+1,0);return t<r.minDate||e.getTime()>r.maxDate},onKeyDown:function(e){var t=i.$date.getMonth(),a=new Date(i.$date);37===e.keyCode?a.setMonth(t-1):38===e.keyCode?a.setMonth(t-4):39===e.keyCode?a.setMonth(t+1):40===e.keyCode&&a.setMonth(t+4),this.isDisabled(a)||i.select(a,!0)}},{name:"year",format:r.yearFormat,split:4,steps:{year:12},update:function(e,t){!this.built||t||parseInt(e.getFullYear()/20,10)!==parseInt($.year/20,10)?(angular.extend($,{year:i.$date.getFullYear(),month:i.$date.getMonth(),date:i.$date.getDate()}),i.$build()):e.getFullYear()!==$.year&&(angular.extend($,{year:i.$date.getFullYear(),month:i.$date.getMonth(),date:i.$date.getDate()}),i.$updateSelected())},build:function(){for(var t,a=$.year-$.year%(3*this.split),n=[],r=0;12>r;r++)t=new Date(a+r,0,1),n.push({date:t,label:l(t,this.format),selected:i.$isSelected(t),disabled:this.isDisabled(t)});o.title=n[0].label+"-"+n[n.length-1].label,o.showLabels=!1,o.rows=e(n,this.split),this.built=!0},isSelected:function(e){return i.$date&&e.getFullYear()===i.$date.getFullYear()},isDisabled:function(e){var t=+new Date(e.getFullYear()+1,0,0);return t<r.minDate||e.getTime()>r.maxDate},onKeyDown:function(e){var t=i.$date.getFullYear(),a=new Date(i.$date);37===e.keyCode?a.setYear(t-1):38===e.keyCode?a.setYear(t-4):39===e.keyCode?a.setYear(t+1):40===e.keyCode&&a.setYear(t+4),this.isDisabled(a)||i.select(a,!0)}}]);return{views:r.minView?Array.prototype.slice.call(m,r.minView):m,viewDate:$}}}]});
//# sourceMappingURL=datepicker.min.js.map