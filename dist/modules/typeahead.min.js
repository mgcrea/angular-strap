/**
 * angular-strap
 * @version v2.3.12 - 2017-03-31
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com> (https://github.com/mgcrea)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
'use strict';angular.module('mgcrea.ngStrap.typeahead',['mgcrea.ngStrap.tooltip','mgcrea.ngStrap.helpers.parseOptions']).provider('$typeahead',function(){var e=this.defaults={animation:'am-fade',prefixClass:'typeahead',prefixEvent:'$typeahead',placement:'bottom-left',templateUrl:'typeahead/typeahead.tpl.html',trigger:'focus',container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:'bsAsyncFilter',limit:6,autoSelect:!1,comparator:'',trimValue:!0,preventHide:!1};this.$get=['$window','$rootScope','$tooltip','$$rAF','$timeout',function(t,n,a,i,o){function r(t,n,r){var c={},s=angular.extend({},e,r);c=a(t,s);var u=r.scope,$=c.$scope;$.$resetMatches=function(){$.$matches=[],$.$activeIndex=s.autoSelect?0:-1},$.$resetMatches(),$.$activate=function(e){$.$$postDigest(function(){c.activate(e)})},$.$select=function(e,t){$.$$postDigest(function(){c.select(e)})},$.$isVisible=function(){return c.$isVisible()},c.update=function(e){$.$matches=e,$.$activeIndex>=e.length&&($.$activeIndex=s.autoSelect?0:-1),l($),i(c.$applyPlacement)},c.activate=function(e){$.$activeIndex=e},c.select=function(e){if(-1!==e){var t=$.$matches[e].value;n.$setViewValue(t),n.$render(),$.$resetMatches(),u&&u.$digest(),$.$emit(s.prefixEvent+'.select',t,e,c),angular.isDefined(s.onSelect)&&angular.isFunction(s.onSelect)&&s.onSelect(t,e,c)}},c.$isVisible=function(){return s.minLength&&n?$.$matches.length&&angular.isString(n.$viewValue)&&n.$viewValue.length>=s.minLength:!!$.$matches.length},c.$getIndex=function(e){var t;for(t=$.$matches.length;t--&&!angular.equals($.$matches[t].value,e););return t},c.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()},c.$$updateScrollTop=function(e,t){if(t>-1&&t<e.children.length){var n=e.children[t],a=n.offsetTop,i=n.offsetTop+n.clientHeight,o=e.scrollTop,r=e.scrollTop+e.clientHeight;i>=o&&o>a?e.scrollTop=Math.max(0,e.scrollTop-e.clientHeight):i>r&&(e.scrollTop=a)}},c.$onKeyDown=function(e){/(38|40|13)/.test(e.keyCode)&&(!c.$isVisible()||13===e.keyCode&&-1===$.$activeIndex||(e.preventDefault(),e.stopPropagation()),13===e.keyCode&&$.$matches.length?c.select($.$activeIndex):38===e.keyCode&&$.$activeIndex>0?$.$activeIndex--:40===e.keyCode&&$.$activeIndex<$.$matches.length-1?$.$activeIndex++:angular.isUndefined($.$activeIndex)&&($.$activeIndex=0),c.$$updateScrollTop(c.$element[0],$.$activeIndex),$.$digest())};var d=c.show,f=!1;c.show=function(){d(),o(function(){c.$element&&!f&&(c.$element.on('mousedown',c.$onMouseDown),s.keyboard&&t&&t.on('keydown',c.$onKeyDown),f=!0)},0,!1)};var p=c.hide;return c.hide=function(){s.preventHide||(c.$element&&c.$element.off('mousedown',c.$onMouseDown),s.keyboard&&t&&t.off('keydown',c.$onKeyDown),s.autoSelect||c.activate(-1),p(),f=!1)},c}function l(e){e.$$phase||e.$root&&e.$root.$$phase||e.$digest()}return r.defaults=e,r}]}).filter('bsAsyncFilter',['$filter',function(e){return function(t,n,a){return t&&angular.isFunction(t.then)?t.then(function(t){return e('filter')(t,n,a)}):e('filter')(t,n,a)}}]).directive('bsTypeahead',['$window','$parse','$q','$typeahead','$parseOptions','$timeout',function(e,t,n,a,i,o){var r=a.defaults;return{restrict:'EAC',require:'ngModel',link:function(e,t,n,l){t.off('change');var c={scope:e};angular.forEach(['template','templateUrl','controller','controllerAs','placement','container','delay','trigger','keyboard','html','animation','filter','limit','minLength','watchOptions','selectMode','autoSelect','comparator','id','prefixEvent','prefixClass','preventHide'],function(e){angular.isDefined(n[e])&&(c[e]=n[e])});var s=/^(false|0|)$/i;angular.forEach(['html','container','trimValue','filter'],function(e){angular.isDefined(n[e])&&s.test(n[e])&&(c[e]=!1)}),angular.forEach(['onBeforeShow','onShow','onBeforeHide','onHide','onSelect'],function(t){var a='bs'+t.charAt(0).toUpperCase()+t.slice(1);angular.isDefined(n[a])&&(c[t]=e.$eval(n[a]))}),t.attr('autocomplete')||t.attr('autocomplete','off');var u=angular.isDefined(c.filter)?c.filter:r.filter,$=c.limit||r.limit,d=c.comparator||r.comparator,f=n.bsOptions;u&&(f+=' | '+u+':$viewValue',d&&(f+=':'+d)),$&&(f+=' | limitTo:'+$);var p=i(f),h=a(t,l,c);if(c.watchOptions){var g=p.$match[7].replace(/\|.+/,'').replace(/\(.*\)/g,'').trim();e.$watchCollection(g,function(t,n){p.valuesFn(e,l).then(function(e){h.update(e),l.$render()})})}e.$watch(n.ngModel,function(t,n){e.$modelValue=t,p.valuesFn(e,l).then(function(e){return c.selectMode&&!e.length&&t.length>0?void l.$setViewValue(l.$viewValue.substring(0,l.$viewValue.length-1)):(e.length>$&&(e=e.slice(0,$)),h.update(e),void l.$render())})}),l.$formatters.push(function(e){var t=p.displayValue(e);return t?t:angular.isDefined(e)&&'object'!=typeof e?e:''}),l.$render=function(){if(l.$isEmpty(l.$viewValue))return t.val('');var e=h.$getIndex(l.$modelValue),n=-1!==e?h.$scope.$matches[e].label:l.$viewValue;angular.isObject(n)&&!p.displayValue(n)&&angular.isFunction(n.toString)&&(n=n.toString()),n=angular.isObject(n)?p.displayValue(n):n;var a=n?n.toString().replace(/<(?:.|\n)*?>/gm,''):'';t.val(c.trimValue===!1?a:a.trim())},e.$on('$destroy',function(){h&&h.destroy(),c=null,h=null}),c.preventHide&&o(h.show)}}}]);
//# sourceMappingURL=typeahead.min.js.map
