/**
 * angular-strap
 * @version v2.3.12 - 2021-12-03
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com> (https://github.com/mgcrea)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
'use strict';angular.module('mgcrea.ngStrap.typeahead',['mgcrea.ngStrap.tooltip','mgcrea.ngStrap.helpers.parseOptions']).provider('$typeahead',function(){var e=this.defaults={animation:'am-fade',prefixClass:'typeahead',prefixEvent:'$typeahead',placement:'bottom-left',templateUrl:'typeahead/typeahead.tpl.html',trigger:'focus',container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:'bsAsyncFilter',limit:6,autoSelect:!1,comparator:'',trimValue:!0,translations:null,feedbackId:'',selectedProperty:''},t={downArrow:40,enter:13,escape:27,upArrow:38,tab:9};this.$get=['$window','$rootScope','$tooltip','$$rAF','$timeout',function(n,a,i,o,r){function l(n,a,l){function s(e){if(void 0!==e&&f.id){var t=f.$generateResultId(e);t?n.attr('aria-activedescendant',t):n.removeAttr('aria-activedescendant')}else n.removeAttr('aria-activedescendant')}var d={},u=angular.extend({},e,l);d=i(n,u);var $=l.scope,f=d.$scope;f.id=u.id,f.$resetMatches=function(){f.$matches=[],f.$activeIndex=u.autoSelect?0:-1},f.$resetMatches(),f.$activate=function(e){f.$$postDigest(function(){d.activate(e)})},f.$select=function(e,t){f.$$postDigest(function(){d.select(e)})},f.$isVisible=function(){return d.$isVisible()},f.$isActive=function(e){return f.$activeIndex===e||void 0},d.update=function(e){f.$matches=e,f.$activeIndex>=e.length&&(f.$activeIndex=u.autoSelect?0:-1),c(f),o(d.$applyPlacement)},d.activate=function(e){f.$activeIndex=e},d.select=function(e){if(e!==-1){var t=f.$matches[e].value;'object'==typeof t&&void 0!==u.selectedProperty&&u.selectedProperty.length>0?a.$setViewValue(t[u.selectedProperty]):a.$setViewValue(t),a.$render(),f.$resetMatches(),$&&$.$digest(),f.$emit(u.prefixEvent+'.select',t,e,d),angular.isDefined(u.onSelect)&&angular.isFunction(u.onSelect)&&u.onSelect(t,e,d)}},d.$isVisible=function(){return u.minLength&&a?f.$matches.length&&angular.isString(a.$viewValue)&&a.$viewValue.length>=u.minLength:!!f.$matches.length},f.$generateResultId=function(e){return f.id?f.id+'_typeahead_result_'+e:void 0},d.$getIndex=function(e){var t;for(t=f.$matches.length;t--&&!angular.equals(f.$matches[t].value,e););return t},d.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()},d.$$updateScrollTop=function(e,t){if(t>-1&&t<e.children.length){var n=e.children[t],a=n.offsetTop,i=n.offsetTop+n.clientHeight,o=e.scrollTop,r=e.scrollTop+e.clientHeight;i>=o&&a<o?e.scrollTop=Math.max(0,e.scrollTop-e.clientHeight):i>r&&(e.scrollTop=a)}},d.$onKeyDown=function(e){if(/(38|40|13)/.test(e.keyCode)){if(!d.$isVisible()||e.keyCode===t.enter&&f.$activeIndex===-1||(e.preventDefault(),e.stopPropagation()),e.keyCode===t.enter&&f.$matches.length)d.select(f.$activeIndex);else if(e.keyCode===t.upArrow&&f.$activeIndex>0)f.$activeIndex--,s(f.$activeIndex),angular.element(document.getElementById(u.id+'_sr_text')).html(f.$matches[f.$activeIndex].label);else if(e.keyCode===t.downArrow&&f.$activeIndex<f.$matches.length-1)f.$activeIndex++,s(f.$activeIndex),angular.element(document.getElementById(u.id+'_sr_text')).html(f.$matches[f.$activeIndex].label);else if(e.keyCode===t.upArrow&&0===f.$activeIndex||e.keyCode===t.downArrow&&f.$activeIndex===f.$matches.length-1){f.$activeIndex=-1;var n='#'+e.currentTarget.id;angular.element(n).val('').val(a.$viewValue),angular.element(n).focus()}else angular.isUndefined(f.$activeIndex)&&(f.$activeIndex=0,s());d.$$updateScrollTop(d.$element[0],f.$activeIndex),f.$digest()}};var p=d.show;d.show=function(){p(),r(function(){if(d.$element){if(u.id){d.$element.attr('id',u.id+'_listbox'),n.attr('aria-controls',u.id+'_listbox');var e=document.getElementById(u.id+'_sr_text');e||d.$element.parent().append('<div id="'+u.id+'_sr_text" aria-live="assertive" style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0;"></div>')}d.$element.attr('aria-labelledby',u.ariaLabelledby),d.$element.on('mousedown',d.$onMouseDown),u.keyboard&&(n&&n.off('keydown',d.$onKeyDown),n&&n.on('keydown',d.$onKeyDown))}},0,!1)};var m=d.hide;d.hide=function(){d.$element&&d.$element.off('mousedown',d.$onMouseDown),u.keyboard&&n&&n.off('keydown',d.$onKeyDown),u.autoSelect||d.activate(-1);var e=document.getElementById(u.id+'_sr_text');angular.element(e).remove(),s(),m()};d.$onKeyUp;d.$onKeyUp=function(e){e.which===t.escape&&d.$isShown&&(d.hide(),e.stopPropagation())};d.$onFocusKeyUp;return d.$onFocusKeyUp=function(e){if(e.which===t.escape&&void 0!==u.feedbackId&&void 0!==u.translations){var n=angular.fromJson(u.translations),a=document.getElementById(u.feedbackId);void 0!==d.$scope.$matches&&d.$scope.$matches.length>0&&angular.element(a).text(n.selectResultText)}},d}function c(e){e.$$phase||e.$root&&e.$root.$$phase||e.$digest()}return l.defaults=e,l}]}).filter('bsAsyncFilter',['$filter',function(e){return function(t,n,a){return t&&angular.isFunction(t.then)?t.then(function(t){return e('filter')(t,n,a)}):e('filter')(t,n,a)}}]).directive('bsTypeahead',['$window','$parse','$q','$typeahead','$parseOptions',function(e,t,n,a,i){var o=a.defaults;return{restrict:'EAC',require:'ngModel',link:function(e,t,n,r){function l(e){if(void 0!==c.feedbackId){var t=document.getElementById(c.feedbackId);angular.element(t).text(e)}}t.off('change');var c={scope:e};angular.forEach(['template','templateUrl','controller','controllerAs','placement','container','delay','trigger','keyboard','html','animation','filter','limit','minLength','watchOptions','selectMode','autoSelect','comparator','id','prefixEvent','prefixClass','ariaLabelledby','translations','feedbackId','selectedProperty'],function(e){angular.isDefined(n[e])&&(c[e]=n[e])});var s=/^(false|0|)$/i;angular.forEach(['html','container','trimValue','filter'],function(e){angular.isDefined(n[e])&&s.test(n[e])&&(c[e]=!1)}),angular.forEach(['onBeforeShow','onShow','onBeforeHide','onHide','onSelect'],function(t){var a='bs'+t.charAt(0).toUpperCase()+t.slice(1);angular.isDefined(n[a])&&(c[t]=e.$eval(n[a]))}),t.attr('autocomplete')||t.attr('autocomplete','off');var d=angular.isDefined(c.filter)?c.filter:o.filter,u=c.limit||o.limit,$=c.comparator||o.comparator,f=n.bsOptions;d&&(f+=' | '+d+':$viewValue',$&&(f+=':'+$)),u&&(f+=' | limitTo:'+u);var p=i(f),m=a(t,r,c);if(t.attr('aria-autocomplete')||f.templateUrl||t.attr('aria-autocomplete','list'),c.watchOptions){var h=p.$match[7].replace(/\|.+/,'').replace(/\(.*\)/g,'').trim();e.$watchCollection(h,function(t,n){p.valuesFn(e,r).then(function(e){m.update(e),r.$render()})})}e.$watch(n.ngModel,function(t,n){e.$modelValue=t,p.valuesFn(e,r).then(function(e){return c.selectMode&&!e.length&&t.length>0?void r.$setViewValue(r.$viewValue.substring(0,r.$viewValue.length-1)):(e.length>u&&(e=e.slice(0,u)),m.update(e),void r.$render())})}),r.$formatters.push(function(e){var t=p.displayValue(e);return t?t:angular.isDefined(e)&&'object'!=typeof e?e:''}),r.$render=function(){if(r.$isEmpty(r.$viewValue))return l(''),t.val('');var e=m.$getIndex(r.$modelValue),n=e!==-1?m.$scope.$matches[e].label:r.$viewValue;n=angular.isObject(n)?p.displayValue(n):n;var a=n?n.toString().replace(/<(?:.|\n)*?>/gm,''):'',i=t[0].selectionStart,o=t[0].selectionEnd;if(t.val(c.trimValue===!1?a:a.trim()),t[0].setSelectionRange(i,o),void 0!==c.translations&&(l(''),void 0!==m.$scope.$matches)){var s=angular.fromJson(c.translations);l(m.$scope.$matches.length>0?m.$scope.$matches.length+' '+s.resultsText:s.noResultsText)}},t.on('keydown',function(e){if(9===e.which&&(e.preventDefault(),void 0!==c.translations)){var t=angular.fromJson(c.translations);m.$scope.$matches.length>0&&l(t.selectResultText)}}),e.$on('$destroy',function(){t.off('keydown'),m&&m.destroy(),c=null,m=null})}}}]);
//# sourceMappingURL=typeahead.min.js.map
