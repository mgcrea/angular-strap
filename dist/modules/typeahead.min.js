/**
 * angular-strap
 * @version v2.1.0 - 2014-09-05
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.typeahead",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).provider("$typeahead",function(){var e=this.defaults={animation:"am-fade",prefixClass:"typeahead",prefixEvent:"$typeahead",placement:"bottom-left",template:"typeahead/typeahead.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:"filter",limit:6};this.$get=["$window","$rootScope","$tooltip",function(t,n,a){function i(t,n,i){var o={},l=angular.extend({},e,i);o=a(t,l);var r=i.scope,c=o.$scope;c.$resetMatches=function(){c.$matches=[],c.$activeIndex=0},c.$resetMatches(),c.$activate=function(e){c.$$postDigest(function(){o.activate(e)})},c.$select=function(e){c.$$postDigest(function(){o.select(e)})},c.$isVisible=function(){return o.$isVisible()},o.update=function(e){c.$matches=e,c.$activeIndex>=e.length&&(c.$activeIndex=0)},o.activate=function(e){c.$activeIndex=e},o.select=function(e){var t=c.$matches[e].value;n.$setViewValue(t),n.$render(),c.$resetMatches(),r&&r.$digest(),c.$emit(l.prefixEvent+".select",t,e)},o.$isVisible=function(){return l.minLength&&n?c.$matches.length&&angular.isString(n.$viewValue)&&n.$viewValue.length>=l.minLength:!!c.$matches.length},o.$getIndex=function(e){var t=c.$matches.length,n=t;if(t){for(n=t;n--&&c.$matches[n].value!==e;);if(!(0>n))return n}},o.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()},o.$onKeyDown=function(e){/(38|40|13)/.test(e.keyCode)&&(o.$isVisible()&&(e.preventDefault(),e.stopPropagation()),13===e.keyCode&&c.$matches.length?o.select(c.$activeIndex):38===e.keyCode&&c.$activeIndex>0?c.$activeIndex--:40===e.keyCode&&c.$activeIndex<c.$matches.length-1?c.$activeIndex++:angular.isUndefined(c.$activeIndex)&&(c.$activeIndex=0),c.$digest())};var s=o.show;o.show=function(){s(),setTimeout(function(){o.$element.on("mousedown",o.$onMouseDown),l.keyboard&&t.on("keydown",o.$onKeyDown)})};var u=o.hide;return o.hide=function(){o.$element.off("mousedown",o.$onMouseDown),l.keyboard&&t.off("keydown",o.$onKeyDown),u()},o}angular.element(t.document.body);return i.defaults=e,i}]}).directive("bsTypeahead",["$window","$parse","$q","$typeahead","$parseOptions",function(e,t,n,a,i){var o=a.defaults;return{restrict:"EAC",require:"ngModel",link:function(e,t,n,l){var r={scope:e};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","filter","limit","minLength","watchOptions","selectMode"],function(e){angular.isDefined(n[e])&&(r[e]=n[e])});var c=r.filter||o.filter,s=r.limit||o.limit,u=n.ngOptions;c&&(u+=" | "+c+":$viewValue"),s&&(u+=" | limitTo:"+s);var $=i(u),d=a(t,l,r);if(r.watchOptions){var f=$.$match[7].replace(/\|.+/,"").replace(/\(.*\)/g,"").trim();e.$watch(f,function(){$.valuesFn(e,l).then(function(e){d.update(e),l.$render()})},!0)}e.$watch(n.ngModel,function(t){e.$modelValue=t,$.valuesFn(e,l).then(function(e){if(r.selectMode&&!e.length&&t.length>0)return void l.$setViewValue(l.$viewValue.substring(0,l.$viewValue.length-1));e.length>s&&(e=e.slice(0,s));var n=d.$isVisible();n&&d.update(e),(1!==e.length||e[0].value!==t)&&(!n&&d.update(e),l.$render())})}),l.$render=function(){if(l.$isEmpty(l.$viewValue))return t.val("");var e=d.$getIndex(l.$modelValue),n=angular.isDefined(e)?d.$scope.$matches[e].label:l.$viewValue;n=angular.isObject(n)?n.label:n,t.val(n.replace(/<(?:.|\n)*?>/gm,"").trim())},e.$on("$destroy",function(){d&&d.destroy(),r=null,d=null})}}}]);
//# sourceMappingURL=typeahead.min.js.map