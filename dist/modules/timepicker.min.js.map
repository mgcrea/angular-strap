{"version":3,"file":"timepicker.min.js","sources":["timepicker/timepicker.js"],"names":["angular","module","provider","defaults","this","animation","prefixClass","placement","template","trigger","container","keyboard","html","delay","useNative","timeType","timeFormat","modelTimeFormat","autoclose","minTime","Infinity","maxTime","length","hourStep","minuteStep","iconUp","iconDown","arrowBehavior","$get","$window","$document","$rootScope","$sce","$locale","dateFilter","$tooltip","timepickerFactory","element","controller","config","createSelection","start","end","createTextRange","selRange","collapse","moveStart","moveEnd","select","setSelectionRange","isUndefined","selectionStart","selectionEnd","focusElement","focus","$timepicker","extend","parentScope","scope","options","$options","$scope","selectedIndex","startDate","$dateValue","Date","viewDate","hour","getHours","meridian","minute","getMinutes","second","getSeconds","millisecond","getMilliseconds","format","DATETIME_FORMATS","formats","exec","slice","$iconUp","$iconDown","$select","date","index","$moveIndex","value","$switchMeridian","switchMeridian","update","isDate","isNaN","getTime","$date","$build","$isBuilt","keep","setHours","setMinutes","$setViewValue","$render","hide","hours","i","midIndex","parseInt","push","label","selected","$isSelected","disabled","$isDisabled","minutes","rows","showAM","isAM","timeSeparator","selectedTime","$arrowAction","$setTimeByStep","newDate","$digest","targetDate","$onMouseDown","evt","target","nodeName","toLowerCase","preventDefault","stopPropagation","isTouch","targetEl","parent","triggerHandler","$onKeyDown","test","keyCode","shiftKey","altKey","hoursLength","minutesLength","lateralMove","count","selectRange","_init","init","isNative","prop","css","attr","on","_destroy","destroy","off","_show","show","setTimeout","$element","_hide","blur","document","body","navigator","userAgent","lang","id","directive","$parse","$q","$dateParser","requestAnimationFrame","restrict","require","link","forEach","key","isDefined","bsShow","$watch","newValue","timepicker","isString","match","dateParser","$observe","setFullYear","substr","parse","ngModel","$parsers","unshift","viewValue","$setValidity","parsedTime","isValid","toISOString","$formatters","modelValue","NaN","val","$on"],"mappings":"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","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.timepicker', ['mgcrea.ngStrap.helpers.dateParser', 'mgcrea.ngStrap.tooltip'])\n\n  .provider('$timepicker', function() {\n\n    var defaults = this.defaults = {\n      animation: 'am-fade',\n      prefixClass: 'timepicker',\n      placement: 'bottom-left',\n      template: 'timepicker/timepicker.tpl.html',\n      trigger: 'focus',\n      container: false,\n      keyboard: true,\n      html: false,\n      delay: 0,\n      // lang: $locale.id,\n      useNative: true,\n      timeType: 'date',\n      timeFormat: 'shortTime',\n      modelTimeFormat: null,\n      autoclose: false,\n      minTime: -Infinity,\n      maxTime: +Infinity,\n      length: 5,\n      hourStep: 1,\n      minuteStep: 5,\n      iconUp: 'glyphicon glyphicon-chevron-up',\n      iconDown: 'glyphicon glyphicon-chevron-down',\n      arrowBehavior: 'pager'\n    };\n\n    this.$get = function($window, $document, $rootScope, $sce, $locale, dateFilter, $tooltip) {\n\n      var bodyEl = angular.element($window.document.body);\n      var isNative = /(ip(a|o)d|iphone|android)/ig.test($window.navigator.userAgent);\n      var isTouch = ('createTouch' in $window.document) && isNative;\n      if(!defaults.lang) defaults.lang = $locale.id;\n\n      function timepickerFactory(element, controller, config) {\n\n        var $timepicker = $tooltip(element, angular.extend({}, defaults, config));\n        var parentScope = config.scope;\n        var options = $timepicker.$options;\n        var scope = $timepicker.$scope;\n\n        // View vars\n\n        var selectedIndex = 0;\n        var startDate = controller.$dateValue || new Date();\n        var viewDate = {hour: startDate.getHours(), meridian: startDate.getHours() < 12, minute: startDate.getMinutes(), second: startDate.getSeconds(), millisecond: startDate.getMilliseconds()};\n\n        var format = $locale.DATETIME_FORMATS[options.timeFormat] || options.timeFormat;\n        var formats = /(h+)([:\\.])?(m+)[ ]?(a?)/i.exec(format).slice(1);\n        scope.$iconUp = options.iconUp;\n        scope.$iconDown = options.iconDown;\n\n        // Scope methods\n\n        scope.$select = function(date, index) {\n          $timepicker.select(date, index);\n        };\n        scope.$moveIndex = function(value, index) {\n          $timepicker.$moveIndex(value, index);\n        };\n        scope.$switchMeridian = function(date) {\n          $timepicker.switchMeridian(date);\n        };\n\n        // Public methods\n\n        $timepicker.update = function(date) {\n          // console.warn('$timepicker.update() newValue=%o', date);\n          if(angular.isDate(date) && !isNaN(date.getTime())) {\n            $timepicker.$date = date;\n            angular.extend(viewDate, {hour: date.getHours(), minute: date.getMinutes(), second: date.getSeconds(), millisecond: date.getMilliseconds()});\n            $timepicker.$build();\n          } else if(!$timepicker.$isBuilt) {\n            $timepicker.$build();\n          }\n        };\n\n        $timepicker.select = function(date, index, keep) {\n          // console.warn('$timepicker.select', date, scope.$mode);\n          if(!controller.$dateValue || isNaN(controller.$dateValue.getTime())) controller.$dateValue = new Date(1970, 0, 1);\n          if(!angular.isDate(date)) date = new Date(date);\n          if(index === 0) controller.$dateValue.setHours(date.getHours());\n          else if(index === 1) controller.$dateValue.setMinutes(date.getMinutes());\n          controller.$setViewValue(controller.$dateValue);\n          controller.$render();\n          if(options.autoclose && !keep) {\n            $timepicker.hide(true);\n          }\n        };\n\n        $timepicker.switchMeridian = function(date) {\n          var hours = (date || controller.$dateValue).getHours();\n          controller.$dateValue.setHours(hours < 12 ? hours + 12 : hours - 12);\n          controller.$setViewValue(controller.$dateValue);\n          controller.$render();\n        };\n\n        // Protected methods\n\n        $timepicker.$build = function() {\n          // console.warn('$timepicker.$build() viewDate=%o', viewDate);\n          var i, midIndex = scope.midIndex = parseInt(options.length / 2, 10);\n          var hours = [], hour;\n          for(i = 0; i < options.length; i++) {\n            hour = new Date(1970, 0, 1, viewDate.hour - (midIndex - i) * options.hourStep);\n            hours.push({date: hour, label: dateFilter(hour, formats[0]), selected: $timepicker.$date && $timepicker.$isSelected(hour, 0), disabled: $timepicker.$isDisabled(hour, 0)});\n          }\n          var minutes = [], minute;\n          for(i = 0; i < options.length; i++) {\n            minute = new Date(1970, 0, 1, 0, viewDate.minute - (midIndex - i) * options.minuteStep);\n            minutes.push({date: minute, label: dateFilter(minute, formats[2]), selected: $timepicker.$date && $timepicker.$isSelected(minute, 1), disabled: $timepicker.$isDisabled(minute, 1)});\n          }\n\n          var rows = [];\n          for(i = 0; i < options.length; i++) {\n            rows.push([hours[i], minutes[i]]);\n          }\n          scope.rows = rows;\n          scope.showAM = !!formats[3];\n          scope.isAM = ($timepicker.$date || hours[midIndex].date).getHours() < 12;\n          scope.timeSeparator = formats[1];\n          $timepicker.$isBuilt = true;\n        };\n\n        $timepicker.$isSelected = function(date, index) {\n          if(!$timepicker.$date) return false;\n          else if(index === 0) {\n            return date.getHours() === $timepicker.$date.getHours();\n          } else if(index === 1) {\n            return date.getMinutes() === $timepicker.$date.getMinutes();\n          }\n        };\n\n        $timepicker.$isDisabled = function(date, index) {\n          var selectedTime;\n          if(index === 0) {\n            selectedTime = date.getTime() + viewDate.minute * 6e4;\n          } else if(index === 1) {\n            selectedTime = date.getTime() + viewDate.hour * 36e5;\n          }\n          return selectedTime < options.minTime * 1 || selectedTime > options.maxTime * 1;\n        };\n\n        scope.$arrowAction = function (value, index) {\n          if (options.arrowBehavior === 'picker') {\n            $timepicker.$setTimeByStep(value,index);\n          } else {\n            $timepicker.$moveIndex(value,index);\n          }\n        };\n\n        $timepicker.$setTimeByStep = function(value, index) {\n          var newDate = new Date($timepicker.$date);\n          var hours = newDate.getHours(), hoursLength = dateFilter(newDate, 'h').length;\n          var minutes = newDate.getMinutes(), minutesLength = dateFilter(newDate, 'mm').length;\n          if (index === 0) {\n            newDate.setHours(hours - (parseInt(options.hourStep, 10) * value));\n          }\n          else {\n            newDate.setMinutes(minutes - (parseInt(options.minuteStep, 10) * value));\n          }\n          $timepicker.select(newDate, index, true);\n          parentScope.$digest();\n        };\n\n        $timepicker.$moveIndex = function(value, index) {\n          var targetDate;\n          if(index === 0) {\n            targetDate = new Date(1970, 0, 1, viewDate.hour + (value * options.length), viewDate.minute);\n            angular.extend(viewDate, {hour: targetDate.getHours()});\n          } else if(index === 1) {\n            targetDate = new Date(1970, 0, 1, viewDate.hour, viewDate.minute + (value * options.length * options.minuteStep));\n            angular.extend(viewDate, {minute: targetDate.getMinutes()});\n          }\n          $timepicker.$build();\n        };\n\n        $timepicker.$onMouseDown = function(evt) {\n          // Prevent blur on mousedown on .dropdown-menu\n          if(evt.target.nodeName.toLowerCase() !== 'input') evt.preventDefault();\n          evt.stopPropagation();\n          // Emulate click for mobile devices\n          if(isTouch) {\n            var targetEl = angular.element(evt.target);\n            if(targetEl[0].nodeName.toLowerCase() !== 'button') {\n              targetEl = targetEl.parent();\n            }\n            targetEl.triggerHandler('click');\n          }\n        };\n\n        $timepicker.$onKeyDown = function(evt) {\n          if (!/(38|37|39|40|13)/.test(evt.keyCode) || evt.shiftKey || evt.altKey) return;\n          evt.preventDefault();\n          evt.stopPropagation();\n\n          // Close on enter\n          if(evt.keyCode === 13) return $timepicker.hide(true);\n\n          // Navigate with keyboard\n          var newDate = new Date($timepicker.$date);\n          var hours = newDate.getHours(), hoursLength = dateFilter(newDate, 'h').length;\n          var minutes = newDate.getMinutes(), minutesLength = dateFilter(newDate, 'mm').length;\n          var lateralMove = /(37|39)/.test(evt.keyCode);\n          var count = 2 + !!formats[3] * 1;\n\n          // Navigate indexes (left, right)\n          if (lateralMove) {\n            if(evt.keyCode === 37) selectedIndex = selectedIndex < 1 ? count - 1 : selectedIndex - 1;\n            else if(evt.keyCode === 39) selectedIndex = selectedIndex < count - 1 ? selectedIndex + 1 : 0;\n          }\n\n          // Update values (up, down)\n          var selectRange = [0, hoursLength];\n          if(selectedIndex === 0) {\n            if(evt.keyCode === 38) newDate.setHours(hours - parseInt(options.hourStep, 10));\n            else if(evt.keyCode === 40) newDate.setHours(hours + parseInt(options.hourStep, 10));\n            selectRange = [0, hoursLength];\n          } else if(selectedIndex === 1) {\n            if(evt.keyCode === 38) newDate.setMinutes(minutes - parseInt(options.minuteStep, 10));\n            else if(evt.keyCode === 40) newDate.setMinutes(minutes + parseInt(options.minuteStep, 10));\n            selectRange = [hoursLength + 1, hoursLength + 1 + minutesLength];\n          } else if(selectedIndex === 2) {\n            if(!lateralMove) $timepicker.switchMeridian();\n            selectRange = [hoursLength + 1 + minutesLength + 1, hoursLength + 1 + minutesLength + 3];\n          }\n          $timepicker.select(newDate, selectedIndex, true);\n          createSelection(selectRange[0], selectRange[1]);\n          parentScope.$digest();\n        };\n\n        // Private\n\n        function createSelection(start, end) {\n          if(element[0].createTextRange) {\n            var selRange = element[0].createTextRange();\n            selRange.collapse(true);\n            selRange.moveStart('character', start);\n            selRange.moveEnd('character', end);\n            selRange.select();\n          } else if(element[0].setSelectionRange) {\n            element[0].setSelectionRange(start, end);\n          } else if(angular.isUndefined(element[0].selectionStart)) {\n            element[0].selectionStart = start;\n            element[0].selectionEnd = end;\n          }\n        }\n\n        function focusElement() {\n          element[0].focus();\n        }\n\n        // Overrides\n\n        var _init = $timepicker.init;\n        $timepicker.init = function() {\n          if(isNative && options.useNative) {\n            element.prop('type', 'time');\n            element.css('-webkit-appearance', 'textfield');\n            return;\n          } else if(isTouch) {\n            element.prop('type', 'text');\n            element.attr('readonly', 'true');\n            element.on('click', focusElement);\n          }\n          _init();\n        };\n\n        var _destroy = $timepicker.destroy;\n        $timepicker.destroy = function() {\n          if(isNative && options.useNative) {\n            element.off('click', focusElement);\n          }\n          _destroy();\n        };\n\n        var _show = $timepicker.show;\n        $timepicker.show = function() {\n          _show();\n          setTimeout(function() {\n            $timepicker.$element.on(isTouch ? 'touchstart' : 'mousedown', $timepicker.$onMouseDown);\n            if(options.keyboard) {\n              element.on('keydown', $timepicker.$onKeyDown);\n            }\n          });\n        };\n\n        var _hide = $timepicker.hide;\n        $timepicker.hide = function(blur) {\n          $timepicker.$element.off(isTouch ? 'touchstart' : 'mousedown', $timepicker.$onMouseDown);\n          if(options.keyboard) {\n            element.off('keydown', $timepicker.$onKeyDown);\n          }\n          _hide(blur);\n        };\n\n        return $timepicker;\n\n      }\n\n      timepickerFactory.defaults = defaults;\n      return timepickerFactory;\n\n    };\n\n  })\n\n\n  .directive('bsTimepicker', function($window, $parse, $q, $locale, dateFilter, $timepicker, $dateParser, $timeout) {\n\n    var defaults = $timepicker.defaults;\n    var isNative = /(ip(a|o)d|iphone|android)/ig.test($window.navigator.userAgent);\n    var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;\n\n    return {\n      restrict: 'EAC',\n      require: 'ngModel',\n      link: function postLink(scope, element, attr, controller) {\n\n        // Directive options\n        var options = {scope: scope, controller: controller};\n        angular.forEach(['placement', 'container', 'delay', 'trigger', 'keyboard', 'html', 'animation', 'template', 'autoclose', 'timeType', 'timeFormat', 'modelTimeFormat', 'useNative', 'hourStep', 'minuteStep', 'length', 'arrowBehavior'], function(key) {\n          if(angular.isDefined(attr[key])) options[key] = attr[key];\n        });\n\n        // Visibility binding support\n        attr.bsShow && scope.$watch(attr.bsShow, function(newValue, oldValue) {\n          if(!timepicker || !angular.isDefined(newValue)) return;\n          if(angular.isString(newValue)) newValue = newValue.match(',?(timepicker),?');\n          newValue === true ? timepicker.show() : timepicker.hide();\n        });\n\n        // Initialize timepicker\n        if(isNative && (options.useNative || defaults.useNative)) options.timeFormat = 'HH:mm';\n        var timepicker = $timepicker(element, controller, options);\n        options = timepicker.$options;\n\n        // Initialize parser\n        var dateParser = $dateParser({format: options.timeFormat, lang: options.lang});\n\n        // Observe attributes for changes\n        angular.forEach(['minTime', 'maxTime'], function(key) {\n          // console.warn('attr.$observe(%s)', key, attr[key]);\n          angular.isDefined(attr[key]) && attr.$observe(key, function(newValue) {\n            if(newValue === 'now') {\n              timepicker.$options[key] = new Date().setFullYear(1970, 0, 1);\n            } else if(angular.isString(newValue) && newValue.match(/^\".+\"$/)) {\n              timepicker.$options[key] = +new Date(newValue.substr(1, newValue.length - 2));\n            } else {\n              timepicker.$options[key] = dateParser.parse(newValue, new Date(1970, 0, 1, 0));\n            }\n            !isNaN(timepicker.$options[key]) && timepicker.$build();\n          });\n        });\n\n        // Watch model for changes\n        scope.$watch(attr.ngModel, function(newValue, oldValue) {\n          // console.warn('scope.$watch(%s)', attr.ngModel, newValue, oldValue, controller.$dateValue);\n          timepicker.update(controller.$dateValue);\n        }, true);\n\n        // viewValue -> $parsers -> modelValue\n        controller.$parsers.unshift(function(viewValue) {\n          // console.warn('$parser(\"%s\"): viewValue=%o', element.attr('ng-model'), viewValue);\n          // Null values should correctly reset the model value & validity\n          if(!viewValue) {\n            controller.$setValidity('date', true);\n            return;\n          }\n          var parsedTime = dateParser.parse(viewValue, controller.$dateValue);\n          if(!parsedTime || isNaN(parsedTime.getTime())) {\n            controller.$setValidity('date', false);\n          } else {\n            var isValid = parsedTime.getTime() >= options.minTime && parsedTime.getTime() <= options.maxTime;\n            controller.$setValidity('date', isValid);\n            // Only update the model when we have a valid date\n            if(isValid) controller.$dateValue = parsedTime;\n          }\n          if(options.timeType === 'string') {\n            return dateFilter(parsedTime, options.modelTimeFormat || options.timeFormat);\n          } else if(options.timeType === 'number') {\n            return controller.$dateValue.getTime();\n          } else if(options.timeType === 'iso') {\n            return controller.$dateValue.toISOString();\n          } else {\n            return new Date(controller.$dateValue);\n          }\n        });\n\n        // modelValue -> $formatters -> viewValue\n        controller.$formatters.push(function(modelValue) {\n          // console.warn('$formatter(\"%s\"): modelValue=%o (%o)', element.attr('ng-model'), modelValue, typeof modelValue);\n          var date;\n          if(angular.isUndefined(modelValue) || modelValue === null) {\n            date = NaN;\n          } else if(angular.isDate(modelValue)) {\n            date = modelValue;\n          } else if(options.timeType === 'string') {\n            date = dateParser.parse(modelValue, null, options.modelTimeFormat);\n          } else {\n            date = new Date(modelValue);\n          }\n          // Setup default value?\n          // if(isNaN(date.getTime())) date = new Date(new Date().setMinutes(0) + 36e5);\n          controller.$dateValue = date;\n          return controller.$dateValue;\n        });\n\n        // viewValue -> element\n        controller.$render = function() {\n          // console.warn('$render(\"%s\"): viewValue=%o', element.attr('ng-model'), controller.$viewValue);\n          element.val(!controller.$dateValue || isNaN(controller.$dateValue.getTime()) ? '' : dateFilter(controller.$dateValue, options.timeFormat));\n        };\n\n        // Garbage collection\n        scope.$on('$destroy', function() {\n          timepicker.destroy();\n          options = null;\n          timepicker = null;\n        });\n\n      }\n    };\n\n  });\n"],"sourceRoot":"/source/"}