{"version":3,"file":"modal.min.js","sources":["modal\\modal.js"],"names":["angular","module","provider","defaults","this","animation","backdropAnimation","prefixClass","prefixEvent","placement","template","contentTemplate","container","element","backdrop","keyboard","html","show","$get","$window","$rootScope","$compile","$q","$templateCache","$http","$animate","$timeout","$sce","ModalFactory","config","hideOnBackdropClick","evt","target","currentTarget","options","$modal","focus","hide","$options","extend","$promise","fetchTemplate","scope","$scope","$new","forEach","key","trustAsHtml","$hide","$$postDigest","$show","$toggle","toggle","then","templateEl","contentEl","findElement","removeAttr","next","remove","outerHTML","modalLinker","modalElement","backdropElement","isObject","data","replace","htmlReplaceRegExp","trim","apply","init","destroy","$destroy","$emit","parent","isElement","after","$element","css","display","addClass","enter","bodyElement","$isShown","$$phase","$root","$digest","el","requestAnimationFrame","on","$onKeyUp","leave","removeClass","off","which","query","document","querySelectorAll","when","get","res","put","String","prototype","setTimeout","body","directive","$location","restrict","link","attr","isDefined","$observe","newValue","bsModal","$watch","content","modal","trigger","$on"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nangular.module('mgcrea.ngStrap.modal', ['mgcrea.ngStrap.helpers.dimensions'])\r\n\r\n  .provider('$modal', function() {\r\n\r\n    var defaults = this.defaults = {\r\n      animation: 'am-fade',\r\n      backdropAnimation: 'am-fade',\r\n      prefixClass: 'modal',\r\n      prefixEvent: 'modal',\r\n      placement: 'top',\r\n      template: 'modal/modal.tpl.html',\r\n      contentTemplate: false,\r\n      container: false,\r\n      element: null,\r\n      backdrop: true,\r\n      keyboard: true,\r\n      html: false,\r\n      show: true\r\n    };\r\n\r\n    this.$get = function($window, $rootScope, $compile, $q, $templateCache, $http, $animate, $timeout, $sce, dimensions) {\r\n\r\n      var forEach = angular.forEach;\r\n      var trim = String.prototype.trim;\r\n      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;\r\n      var bodyElement = angular.element($window.document.body);\r\n      var htmlReplaceRegExp = /ng-bind=\"/ig;\r\n\r\n      function ModalFactory(config) {\r\n\r\n        var $modal = {};\r\n\r\n        // Common vars\r\n        var options = $modal.$options = angular.extend({}, defaults, config);\r\n        $modal.$promise = fetchTemplate(options.template);\r\n        var scope = $modal.$scope = options.scope && options.scope.$new() || $rootScope.$new();\r\n        if(!options.element && !options.container) {\r\n          options.container = 'body';\r\n        }\r\n\r\n        // Support scope as string options\r\n        forEach(['title', 'content'], function(key) {\r\n          if(options[key]) scope[key] = $sce.trustAsHtml(options[key]);\r\n        });\r\n\r\n        // Provide scope helpers\r\n        scope.$hide = function() {\r\n          scope.$$postDigest(function() {\r\n            $modal.hide();\r\n          });\r\n        };\r\n        scope.$show = function() {\r\n          scope.$$postDigest(function() {\r\n            $modal.show();\r\n          });\r\n        };\r\n        scope.$toggle = function() {\r\n          scope.$$postDigest(function() {\r\n            $modal.toggle();\r\n          });\r\n        };\r\n\r\n        // Support contentTemplate option\r\n        if(options.contentTemplate) {\r\n          $modal.$promise = $modal.$promise.then(function(template) {\r\n            var templateEl = angular.element(template);\r\n            return fetchTemplate(options.contentTemplate)\r\n            .then(function(contentTemplate) {\r\n              var contentEl = findElement('[ng-bind=\"content\"]', templateEl[0]).removeAttr('ng-bind').html(contentTemplate);\r\n              // Drop the default footer as you probably don't want it if you use a custom contentTemplate\r\n              if(!config.template) contentEl.next().remove();\r\n              return templateEl[0].outerHTML;\r\n            });\r\n          });\r\n        }\r\n\r\n        // Fetch, compile then initialize modal\r\n        var modalLinker, modalElement;\r\n        var backdropElement = angular.element('<div class=\"' + options.prefixClass + '-backdrop\"/>');\r\n        $modal.$promise.then(function(template) {\r\n          if(angular.isObject(template)) template = template.data;\r\n          if(options.html) template = template.replace(htmlReplaceRegExp, 'ng-bind-html=\"');\r\n          template = trim.apply(template);\r\n          modalLinker = $compile(template);\r\n          $modal.init();\r\n        });\r\n\r\n        $modal.init = function() {\r\n\r\n          // Options: show\r\n          if(options.show) {\r\n            scope.$$postDigest(function() {\r\n              $modal.show();\r\n            });\r\n          }\r\n\r\n        };\r\n\r\n        $modal.destroy = function() {\r\n\r\n          // Remove element\r\n          if(modalElement) {\r\n            modalElement.remove();\r\n            modalElement = null;\r\n          }\r\n          if(backdropElement) {\r\n            backdropElement.remove();\r\n            backdropElement = null;\r\n          }\r\n\r\n          // Destroy scope\r\n          scope.$destroy();\r\n\r\n        };\r\n\r\n        $modal.show = function() {\r\n\r\n          scope.$emit(options.prefixEvent + '.show.before', $modal);\r\n          var parent;\r\n          if(angular.isElement(options.container)) {\r\n            parent = options.container;\r\n          } else {\r\n            parent = options.container ? findElement(options.container) : null;\r\n          }\r\n          var after = options.container ? null : options.element;\r\n\r\n          // Fetch a cloned element linked from template\r\n          modalElement = $modal.$element = modalLinker(scope, function(clonedElement, scope) {});\r\n\r\n          // Set the initial positioning.\r\n          modalElement.css({display: 'block'}).addClass(options.placement);\r\n\r\n          // Options: animation\r\n          if(options.animation) {\r\n            if(options.backdrop) {\r\n              backdropElement.addClass(options.backdropAnimation);\r\n            }\r\n            modalElement.addClass(options.animation);\r\n          }\r\n\r\n          if(options.backdrop) {\r\n            $animate.enter(backdropElement, bodyElement, null, function() {});\r\n          }\r\n          $animate.enter(modalElement, parent, after, function() {\r\n            scope.$emit(options.prefixEvent + '.show', $modal);\r\n          });\r\n          scope.$isShown = true;\r\n          scope.$$phase || (scope.$root && scope.$root.$$phase) || scope.$digest();\r\n          // Focus once the enter-animation has started\r\n          // Weird PhantomJS bug hack\r\n          var el = modalElement[0];\r\n          requestAnimationFrame(function() {\r\n            el.focus();\r\n          });\r\n\r\n          bodyElement.addClass(options.prefixClass + '-open');\r\n          if(options.animation) {\r\n            bodyElement.addClass(options.prefixClass + '-with-' + options.animation);\r\n          }\r\n\r\n          // Bind events\r\n          if(options.backdrop) {\r\n            modalElement.on('click', hideOnBackdropClick);\r\n            backdropElement.on('click', hideOnBackdropClick);\r\n          }\r\n          if(options.keyboard) {\r\n            modalElement.on('keyup', $modal.$onKeyUp);\r\n          }\r\n        };\r\n\r\n        $modal.hide = function() {\r\n\r\n          scope.$emit(options.prefixEvent + '.hide.before', $modal);\r\n          $animate.leave(modalElement, function() {\r\n            scope.$emit(options.prefixEvent + '.hide', $modal);\r\n            bodyElement.removeClass(options.prefixClass + '-open');\r\n            if(options.animation) {\r\n              bodyElement.removeClass(options.prefixClass + '-with-' + options.animation);\r\n            }\r\n          });\r\n          if(options.backdrop) {\r\n            $animate.leave(backdropElement, function() {});\r\n          }\r\n          scope.$isShown = false;\r\n          scope.$$phase || (scope.$root && scope.$root.$$phase) || scope.$digest();\r\n\r\n          // Unbind events\r\n          if(options.backdrop) {\r\n            modalElement.off('click', hideOnBackdropClick);\r\n            backdropElement.off('click', hideOnBackdropClick);\r\n          }\r\n          if(options.keyboard) {\r\n            modalElement.off('keyup', $modal.$onKeyUp);\r\n          }\r\n        };\r\n\r\n        $modal.toggle = function() {\r\n\r\n          scope.$isShown ? $modal.hide() : $modal.show();\r\n\r\n        };\r\n\r\n        $modal.focus = function() {\r\n          modalElement[0].focus();\r\n        };\r\n\r\n        // Protected methods\r\n\r\n        $modal.$onKeyUp = function(evt) {\r\n\r\n          evt.which === 27 && $modal.hide();\r\n\r\n        };\r\n\r\n        // Private methods\r\n\r\n        function hideOnBackdropClick(evt) {\r\n          if(evt.target !== evt.currentTarget) return;\r\n          options.backdrop === 'static' ? $modal.focus() : $modal.hide();\r\n        }\r\n\r\n        return $modal;\r\n\r\n      }\r\n\r\n      // Helper functions\r\n\r\n      function findElement(query, element) {\r\n        return angular.element((element || document).querySelectorAll(query));\r\n      }\r\n\r\n      function fetchTemplate(template) {\r\n        return $q.when($templateCache.get(template) || $http.get(template))\r\n        .then(function(res) {\r\n          if(angular.isObject(res)) {\r\n            $templateCache.put(template, res.data);\r\n            return res.data;\r\n          }\r\n          return res;\r\n        });\r\n      }\r\n\r\n      return ModalFactory;\r\n\r\n    };\r\n\r\n  })\r\n\r\n  .directive('bsModal', function($window, $location, $sce, $modal) {\r\n\r\n    return {\r\n      restrict: 'EAC',\r\n      scope: true,\r\n      link: function postLink(scope, element, attr, transclusion) {\r\n\r\n        // Directive options\r\n        var options = {scope: scope, element: element, show: false};\r\n        angular.forEach(['template', 'contentTemplate', 'placement', 'backdrop', 'keyboard', 'html', 'container', 'animation'], function(key) {\r\n          if(angular.isDefined(attr[key])) options[key] = attr[key];\r\n        });\r\n\r\n        // Support scope as data-attrs\r\n        angular.forEach(['title', 'content'], function(key) {\r\n          attr[key] && attr.$observe(key, function(newValue, oldValue) {\r\n            scope[key] = $sce.trustAsHtml(newValue);\r\n          });\r\n        });\r\n\r\n        // Support scope as an object\r\n        attr.bsModal && scope.$watch(attr.bsModal, function(newValue, oldValue) {\r\n          if(angular.isObject(newValue)) {\r\n            angular.extend(scope, newValue);\r\n          } else {\r\n            scope.content = newValue;\r\n          }\r\n        }, true);\r\n\r\n        // Initialize modal\r\n        var modal = $modal(options);\r\n\r\n        // Trigger\r\n        element.on(attr.trigger || 'click', modal.toggle);\r\n\r\n        // Garbage collection\r\n        scope.$on('$destroy', function() {\r\n          modal.destroy();\r\n          options = null;\r\n          modal = null;\r\n        });\r\n\r\n      }\r\n    };\r\n\r\n  });\r\n"],"sourceRoot":"/source/"}