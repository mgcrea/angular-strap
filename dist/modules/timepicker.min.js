/**
 * angular-strap
 * @version v2.1.2 - 2014-10-19
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.timepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.tooltip"]).provider("$timepicker",function(){var e=this.defaults={animation:"am-fade",prefixClass:"timepicker",placement:"bottom-left",template:"timepicker/timepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!0,timeType:"date",timeFormat:"shortTime",modelTimeFormat:null,autoclose:!1,minTime:-1/0,maxTime:+1/0,length:5,hourStep:1,minuteStep:5,iconUp:"glyphicon glyphicon-chevron-up",iconDown:"glyphicon glyphicon-chevron-down",arrowBehavior:"pager"};this.$get=["$window","$document","$rootScope","$sce","$locale","dateFilter","$tooltip","$timeout",function(t,i,n,a,o,r,u,s){function l(t,i,n){function a(e,i){if(t[0].createTextRange){var n=t[0].createTextRange();n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",i),n.select()}else t[0].setSelectionRange?t[0].setSelectionRange(e,i):angular.isUndefined(t[0].selectionStart)&&(t[0].selectionStart=e,t[0].selectionEnd=i)}function l(){t[0].focus()}var c=u(t,angular.extend({},e,n)),g=n.scope,$=c.$options,p=c.$scope,h=0,f=i.$dateValue||new Date,v={hour:f.getHours(),meridian:f.getHours()<12,minute:f.getMinutes(),second:f.getSeconds(),millisecond:f.getMilliseconds()},w=o.DATETIME_FORMATS[$.timeFormat]||$.timeFormat,y=/(h+)([:\.])?(m+)[ ]?(a?)/i.exec(w).slice(1);p.$iconUp=$.iconUp,p.$iconDown=$.iconDown,p.$select=function(e,t){c.select(e,t)},p.$moveIndex=function(e,t){c.$moveIndex(e,t)},p.$switchMeridian=function(e){c.switchMeridian(e)},c.update=function(e){angular.isDate(e)&&!isNaN(e.getTime())?(c.$date=e,angular.extend(v,{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}),c.$build()):c.$isBuilt||c.$build()},c.select=function(e,t,n){(!i.$dateValue||isNaN(i.$dateValue.getTime()))&&(i.$dateValue=new Date(1970,0,1)),angular.isDate(e)||(e=new Date(e)),0===t?i.$dateValue.setHours(e.getHours()):1===t&&i.$dateValue.setMinutes(e.getMinutes()),i.$setViewValue(i.$dateValue),i.$render(),$.autoclose&&!n&&s(function(){c.hide(!0)})},c.switchMeridian=function(e){if(i.$dateValue&&!isNaN(i.$dateValue.getTime())){var t=(e||i.$dateValue).getHours();i.$dateValue.setHours(12>t?t+12:t-12),i.$setViewValue(i.$dateValue),i.$render()}},c.$build=function(){var e,t,i=p.midIndex=parseInt($.length/2,10),n=[];for(e=0;e<$.length;e++)t=new Date(1970,0,1,v.hour-(i-e)*$.hourStep),n.push({date:t,label:r(t,y[0]),selected:c.$date&&c.$isSelected(t,0),disabled:c.$isDisabled(t,0)});var a,o=[];for(e=0;e<$.length;e++)a=new Date(1970,0,1,0,v.minute-(i-e)*$.minuteStep),o.push({date:a,label:r(a,y[2]),selected:c.$date&&c.$isSelected(a,1),disabled:c.$isDisabled(a,1)});var u=[];for(e=0;e<$.length;e++)u.push([n[e],o[e]]);p.rows=u,p.showAM=!!y[3],p.isAM=(c.$date||n[i].date).getHours()<12,p.timeSeparator=y[1],c.$isBuilt=!0},c.$isSelected=function(e,t){return c.$date?0===t?e.getHours()===c.$date.getHours():1===t?e.getMinutes()===c.$date.getMinutes():void 0:!1},c.$isDisabled=function(e,t){var i;return 0===t?i=e.getTime()+6e4*v.minute:1===t&&(i=e.getTime()+36e5*v.hour),i<1*$.minTime||i>1*$.maxTime},p.$arrowAction=function(e,t){"picker"===$.arrowBehavior?c.$setTimeByStep(e,t):c.$moveIndex(e,t)},c.$setTimeByStep=function(e,t){{var i=new Date(c.$date),n=i.getHours(),a=(r(i,"h").length,i.getMinutes());r(i,"mm").length}0===t?i.setHours(n-parseInt($.hourStep,10)*e):i.setMinutes(a-parseInt($.minuteStep,10)*e),c.select(i,t,!0),g.$digest()},c.$moveIndex=function(e,t){var i;0===t?(i=new Date(1970,0,1,v.hour+e*$.length,v.minute),angular.extend(v,{hour:i.getHours()})):1===t&&(i=new Date(1970,0,1,v.hour,v.minute+e*$.length*$.minuteStep),angular.extend(v,{minute:i.getMinutes()})),c.$build()},c.$onMouseDown=function(e){if("input"!==e.target.nodeName.toLowerCase()&&e.preventDefault(),e.stopPropagation(),m){var t=angular.element(e.target);"button"!==t[0].nodeName.toLowerCase()&&(t=t.parent()),t.triggerHandler("click")}},c.$onKeyDown=function(e){if(/(38|37|39|40|13)/.test(e.keyCode)&&!e.shiftKey&&!e.altKey){if(e.preventDefault(),e.stopPropagation(),13===e.keyCode)return c.hide(!0);var t=new Date(c.$date),i=t.getHours(),n=r(t,"h").length,o=t.getMinutes(),u=r(t,"mm").length,s=/(37|39)/.test(e.keyCode),l=2+1*!!y[3];s&&(37===e.keyCode?h=1>h?l-1:h-1:39===e.keyCode&&(h=l-1>h?h+1:0));var d=[0,n];0===h?(38===e.keyCode?t.setHours(i-parseInt($.hourStep,10)):40===e.keyCode&&t.setHours(i+parseInt($.hourStep,10)),d=[0,n]):1===h?(38===e.keyCode?t.setMinutes(o-parseInt($.minuteStep,10)):40===e.keyCode&&t.setMinutes(o+parseInt($.minuteStep,10)),d=[n+1,n+1+u]):2===h&&(s||c.switchMeridian(),d=[n+1+u+1,n+1+u+3]),c.select(t,h,!0),a(d[0],d[1]),g.$digest()}};var T=c.init;c.init=function(){return d&&$.useNative?(t.prop("type","time"),void t.css("-webkit-appearance","textfield")):(m&&(t.prop("type","text"),t.attr("readonly","true"),t.on("click",l)),void T())};var S=c.destroy;c.destroy=function(){d&&$.useNative&&t.off("click",l),S()};var D=c.show;c.show=function(){D(),setTimeout(function(){c.$element.on(m?"touchstart":"mousedown",c.$onMouseDown),$.keyboard&&t.on("keydown",c.$onKeyDown)})};var V=c.hide;return c.hide=function(e){c.$isShown&&(c.$element.off(m?"touchstart":"mousedown",c.$onMouseDown),$.keyboard&&t.off("keydown",c.$onKeyDown),V(e))},c}var d=(angular.element(t.document.body),/(ip(a|o)d|iphone|android)/gi.test(t.navigator.userAgent)),m="createTouch"in t.document&&d;return e.lang||(e.lang=o.id),l.defaults=e,l}]}).directive("bsTimepicker",["$window","$parse","$q","$locale","dateFilter","$timepicker","$dateParser","$timeout",function(e,t,i,n,a,o,r){{var u=o.defaults,s=/(ip(a|o)d|iphone|android)/gi.test(e.navigator.userAgent);e.requestAnimationFrame||e.setTimeout}return{restrict:"EAC",require:"ngModel",link:function(e,t,i,n){var l={scope:e,controller:n};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","timeType","timeFormat","modelTimeFormat","useNative","hourStep","minuteStep","length","arrowBehavior","iconUp","iconDown"],function(e){angular.isDefined(i[e])&&(l[e]=i[e])}),i.bsShow&&e.$watch(i.bsShow,function(e){d&&angular.isDefined(e)&&(angular.isString(e)&&(e=!!e.match(/true|,?(timepicker),?/i)),e===!0?d.show():d.hide())}),s&&(l.useNative||u.useNative)&&(l.timeFormat="HH:mm");var d=o(t,n,l);l=d.$options;var m=r({format:l.timeFormat,lang:l.lang});angular.forEach(["minTime","maxTime"],function(e){angular.isDefined(i[e])&&i.$observe(e,function(t){d.$options[e]=m.getTimeForAttribute(e,t),!isNaN(d.$options[e])&&d.$build()})}),e.$watch(i.ngModel,function(){d.update(n.$dateValue)},!0),n.$parsers.unshift(function(e){if(!e)return void n.$setValidity("date",!0);var t=angular.isDate(e)?e:m.parse(e,n.$dateValue);if(!t||isNaN(t.getTime()))return void n.$setValidity("date",!1);var i=isNaN(l.minTime)||t.getTime()>=l.minTime,o=isNaN(l.maxTime)||t.getTime()<=l.maxTime,r=i&&o;if(n.$setValidity("date",r),n.$setValidity("min",i),n.$setValidity("max",o),r)return n.$dateValue=t,"string"===l.timeType?a(t,l.modelTimeFormat||l.timeFormat):"number"===l.timeType?n.$dateValue.getTime():"iso"===l.timeType?n.$dateValue.toISOString():new Date(n.$dateValue)}),n.$formatters.push(function(e){var t;return t=angular.isUndefined(e)||null===e?0/0:angular.isDate(e)?e:"string"===l.timeType?m.parse(e,null,l.modelTimeFormat):new Date(e),n.$dateValue=t,n.$dateValue}),n.$render=function(){t.val(!n.$dateValue||isNaN(n.$dateValue.getTime())?"":a(n.$dateValue,l.timeFormat))},e.$on("$destroy",function(){d&&d.destroy(),l=null,d=null})}}}]);
//# sourceMappingURL=timepicker.min.js.map