/**
 * angular-strap
 * @version v2.1.0 - 2014-09-21
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.timepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.tooltip"]).provider("$timepicker",function(){var e=this.defaults={animation:"am-fade",prefixClass:"timepicker",placement:"bottom-left",template:"timepicker/timepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!0,timeType:"date",timeFormat:"shortTime",modelTimeFormat:null,autoclose:!1,minTime:-1/0,maxTime:+1/0,length:5,hourStep:1,minuteStep:5,iconUp:"glyphicon glyphicon-chevron-up",iconDown:"glyphicon glyphicon-chevron-down",arrowBehavior:"pager"};this.$get=["$window","$document","$rootScope","$sce","$dateUtil","$tooltip",function(t,n,a,i,o,r){function u(t,n,a){function i(e,n){if(t[0].createTextRange){var a=t[0].createTextRange();a.collapse(!0),a.moveStart("character",e),a.moveEnd("character",n),a.select()}else t[0].setSelectionRange?t[0].setSelectionRange(e,n):angular.isUndefined(t[0].selectionStart)&&(t[0].selectionStart=e,t[0].selectionEnd=n)}function u(){t[0].focus()}var d=r(t,angular.extend({},e,a)),m=a.scope,c=d.$options,g=d.$scope,p=c.lang,$=function(e,t){return o.formatDate(e,t,p)},h=0,f=n.$dateValue||new Date,w={hour:f.getHours(),meridian:f.getHours()<12,minute:f.getMinutes(),second:f.getSeconds(),millisecond:f.getMilliseconds()},v=o.getDatetimeFormat(c.timeFormat,p),y=o.hoursFormat(v),D=o.timeSeparator(v),S=o.minutesFormat(v),T=o.showAM(v);g.$iconUp=c.iconUp,g.$iconDown=c.iconDown,g.$select=function(e,t){d.select(e,t)},g.$moveIndex=function(e,t){d.$moveIndex(e,t)},g.$switchMeridian=function(e){d.switchMeridian(e)},d.update=function(e){angular.isDate(e)&&!isNaN(e.getTime())?(d.$date=e,angular.extend(w,{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}),d.$build()):d.$isBuilt||d.$build()},d.select=function(e,t,a){(!n.$dateValue||isNaN(n.$dateValue.getTime()))&&(n.$dateValue=new Date(1970,0,1)),angular.isDate(e)||(e=new Date(e)),0===t?n.$dateValue.setHours(e.getHours()):1===t&&n.$dateValue.setMinutes(e.getMinutes()),n.$setViewValue(n.$dateValue),n.$render(),c.autoclose&&!a&&d.hide(!0)},d.switchMeridian=function(e){var t=(e||n.$dateValue).getHours();n.$dateValue.setHours(12>t?t+12:t-12),n.$setViewValue(n.$dateValue),n.$render()},d.$build=function(){var e,t,n=g.midIndex=parseInt(c.length/2,10),a=[];for(e=0;e<c.length;e++)t=new Date(1970,0,1,w.hour-(n-e)*c.hourStep),a.push({date:t,label:$(t,y),selected:d.$date&&d.$isSelected(t,0),disabled:d.$isDisabled(t,0)});var i,o=[];for(e=0;e<c.length;e++)i=new Date(1970,0,1,0,w.minute-(n-e)*c.minuteStep),o.push({date:i,label:$(i,S),selected:d.$date&&d.$isSelected(i,1),disabled:d.$isDisabled(i,1)});var r=[];for(e=0;e<c.length;e++)r.push([a[e],o[e]]);g.rows=r,g.showAM=T,g.isAM=(d.$date||a[n].date).getHours()<12,g.timeSeparator=D,d.$isBuilt=!0},d.$isSelected=function(e,t){return d.$date?0===t?e.getHours()===d.$date.getHours():1===t?e.getMinutes()===d.$date.getMinutes():void 0:!1},d.$isDisabled=function(e,t){var n;return 0===t?n=e.getTime()+6e4*w.minute:1===t&&(n=e.getTime()+36e5*w.hour),n<1*c.minTime||n>1*c.maxTime},g.$arrowAction=function(e,t){"picker"===c.arrowBehavior?d.$setTimeByStep(e,t):d.$moveIndex(e,t)},d.$setTimeByStep=function(e,t){{var n=new Date(d.$date),a=n.getHours(),i=($(n,y).length,n.getMinutes());$(n,S).length}0===t?n.setHours(a-parseInt(c.hourStep,10)*e):n.setMinutes(i-parseInt(c.minuteStep,10)*e),d.select(n,t,!0),m.$digest()},d.$moveIndex=function(e,t){var n;0===t?(n=new Date(1970,0,1,w.hour+e*c.length,w.minute),angular.extend(w,{hour:n.getHours()})):1===t&&(n=new Date(1970,0,1,w.hour,w.minute+e*c.length*c.minuteStep),angular.extend(w,{minute:n.getMinutes()})),d.$build()},d.$onMouseDown=function(e){if("input"!==e.target.nodeName.toLowerCase()&&e.preventDefault(),e.stopPropagation(),l){var t=angular.element(e.target);"button"!==t[0].nodeName.toLowerCase()&&(t=t.parent()),t.triggerHandler("click")}},d.$onKeyDown=function(e){if(/(38|37|39|40|13)/.test(e.keyCode)&&!e.shiftKey&&!e.altKey){if(e.preventDefault(),e.stopPropagation(),13===e.keyCode)return d.hide(!0);var t=new Date(d.$date),n=t.getHours(),a=$(t,y).length,o=t.getMinutes(),r=$(t,S).length,u=/(37|39)/.test(e.keyCode),s=2+1*T;u&&(37===e.keyCode?h=1>h?s-1:h-1:39===e.keyCode&&(h=s-1>h?h+1:0));var l=[0,a];0===h?(38===e.keyCode?t.setHours(n-parseInt(c.hourStep,10)):40===e.keyCode&&t.setHours(n+parseInt(c.hourStep,10)),l=[0,a]):1===h?(38===e.keyCode?t.setMinutes(o-parseInt(c.minuteStep,10)):40===e.keyCode&&t.setMinutes(o+parseInt(c.minuteStep,10)),l=[a+1,a+1+r]):2===h&&(u||d.switchMeridian(),l=[a+1+r+1,a+1+r+3]),d.select(t,h,!0),i(l[0],l[1]),m.$digest()}};var k=d.init;d.init=function(){return s&&c.useNative?(t.prop("type","time"),void t.css("-webkit-appearance","textfield")):(l&&(t.prop("type","text"),t.attr("readonly","true"),t.on("click",u)),void k())};var V=d.destroy;d.destroy=function(){s&&c.useNative&&t.off("click",u),V()};var b=d.show;d.show=function(){b(),setTimeout(function(){d.$element.on(l?"touchstart":"mousedown",d.$onMouseDown),c.keyboard&&t.on("keydown",d.$onKeyDown)})};var M=d.hide;return d.hide=function(e){d.$element.off(l?"touchstart":"mousedown",d.$onMouseDown),c.keyboard&&t.off("keydown",d.$onKeyDown),M(e)},d}var s=(angular.element(t.document.body),/(ip(a|o)d|iphone|android)/gi.test(t.navigator.userAgent)),l="createTouch"in t.document&&s;return e.lang||(e.lang=o.getDefaultLocale()),u.defaults=e,u}]}).directive("bsTimepicker",["$window","$parse","$q","$dateUtil","$timepicker","$timeout",function(e,t,n,a,i){{var o=i.defaults,r=/(ip(a|o)d|iphone|android)/gi.test(e.navigator.userAgent);e.requestAnimationFrame||e.setTimeout}return{restrict:"EAC",require:"ngModel",link:function(e,t,n,u){var s={scope:e,controller:u};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","timeType","timeFormat","modelTimeFormat","useNative","hourStep","minuteStep","length","arrowBehavior"],function(e){angular.isDefined(n[e])&&(s[e]=n[e])}),n.bsShow&&e.$watch(n.bsShow,function(e){l&&angular.isDefined(e)&&(angular.isString(e)&&(e=!!e.match(",?(timepicker),?")),e===!0?l.show():l.hide())}),r&&(s.useNative||o.useNative)&&(s.timeFormat="HH:mm");var l=i(t,u,s);s=l.$options;var d=s.lang,m=function(e,t){return a.formatDate(e,t,d)},c=a.getDateParser({format:s.timeFormat,lang:d});angular.forEach(["minTime","maxTime"],function(e){angular.isDefined(n[e])&&n.$observe(e,function(t){l.$options[e]="now"===t?(new Date).setFullYear(1970,0,1):angular.isString(t)&&t.match(/^".+"$/)?+new Date(t.substr(1,t.length-2)):c.parse(t,new Date(1970,0,1,0)),!isNaN(l.$options[e])&&l.$build()})}),e.$watch(n.ngModel,function(){l.update(u.$dateValue)},!0),u.$parsers.unshift(function(e){if(!e)return void u.$setValidity("date",!0);var t=angular.isDate(e)?e:c.parse(e,u.$dateValue);if(!t||isNaN(t.getTime()))u.$setValidity("date",!1);else{var n=t.getTime()>=s.minTime&&t.getTime()<=s.maxTime;u.$setValidity("date",n),n&&(u.$dateValue=t)}return"string"===s.timeType?m(t,s.modelTimeFormat||s.timeFormat):"number"===s.timeType?u.$dateValue.getTime():"iso"===s.timeType?u.$dateValue.toISOString():new Date(u.$dateValue)}),u.$formatters.push(function(e){var t;return t=angular.isUndefined(e)||null===e?0/0:angular.isDate(e)?e:"string"===s.timeType?c.parse(e,null,s.modelTimeFormat):new Date(e),u.$dateValue=t,u.$dateValue}),u.$render=function(){t.val(!u.$dateValue||isNaN(u.$dateValue.getTime())?"":m(u.$dateValue,s.timeFormat))},e.$on("$destroy",function(){l&&l.destroy(),s=null,l=null})}}}]);
//# sourceMappingURL=timepicker.min.js.map